<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OLDA | PRODUCTION HUB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Polices Spécifiques Marquage */
        @font-face { font-family: 'EDO'; src: url('https://db.onlinewebfonts.com/t/20e980300062a7813636545166299d6d.woff2') format('woff2'); }
        @font-face { font-family: 'Rodeo'; src: url('https://db.onlinewebfonts.com/t/92723d90500473a216891a2e994e63f9.woff2') format('woff2'); }
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap');

        /* Police Apple System */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Arial, sans-serif;
            background: #fbfbfd;
            color: #1d1d1f;
            -webkit-font-smoothing: antialiased;
        }

        .apple-card { background: #fff; border-radius: 20px; border: 1px solid rgba(0,0,0,0.08); }
        .input-apple { background: #f5f5f7; border-radius: 12px; border: 1px solid transparent; padding: 14px; font-weight: 500; outline: none; transition: 0.2s; }
        .input-apple:focus { border-color: #0071e3; background: #fff; }

        /* Fiche A6 Format Production */
        .fiche-a6 {
            width: 105mm; height: 148mm; background: #fff; margin: 40px auto;
            padding: 10mm; display: flex; flex-direction: column; justify-content: space-between;
            align-items: center; border-radius: 2px; box-shadow: 0 20px 50px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Mockup T-shirt blanc */
        .tshirt-preview {
            width: 100%; height: 60mm;
            background-image: url('main/images/h001blancav.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-overlay {
            position: absolute;
            top: 42%; /* Position poitrine standard */
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        @media print {
            @page { size: A6; margin: 0; }
            .no-print { display: none !important; }
            .fiche-a6 { margin: 0; box-shadow: none; page-break-after: always; -webkit-print-color-adjust: exact; }
        }

        .step-pill { font-size: 9px; font-weight: 700; padding: 10px; border-radius: 30px; background: #f5f5f7; border: none; flex: 1; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .step-active { background: #000; color: #fff; }

        .color-dot { width: 28px; height: 28px; border-radius: 50%; border: 2px solid #fff; box-shadow: 0 0 0 1px #d2d2d7; cursor: pointer; }
        .color-dot.active { box-shadow: 0 0 0 2px #0071e3; transform: scale(1.1); }
    </style>
</head>
<body class="pb-20">

    <div class="max-w-xl mx-auto p-6 no-print">
        <header class="mb-8 flex justify-between items-center">
            <h1 class="text-2xl font-bold tracking-tight">Olda <span class="font-normal opacity-50">Atelier</span></h1>
            <div class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-[10px] font-bold">H-001 CONNECTÉ</div>
        </header>

        <div class="apple-card p-8 space-y-6">
            <div class="grid grid-cols-2 gap-4">
                <input type="text" id="client" placeholder="NOM CLIENT" class="input-apple w-full uppercase">
                <select id="taille" class="input-apple w-full font-bold">
                    <option>S</option><option>M</option><option>L</option><option>XL</option>
                </select>
            </div>

            <div class="p-6 bg-[#fbfbfd] rounded-2xl border border-gray-100 space-y-5">
                <div class="flex justify-between items-center"><span class="text-xs font-bold text-blue-600">Personnalisation Avant</span> <span id="valSize" class="text-[10px] font-bold opacity-30">60MM</span></div>
                
                <select id="typeAv" class="input-apple w-full" onchange="updateUI()">
                    <option value="SANS">AUCUN</option>
                    <option value="PERSO">TEXTE PERSONNALISÉ</option>
                    <option value="LOGO CLIENT">LOGO CLIENT (IMAGE)</option>
                    <option value="BEA-16AV">BEA-16AV</option>
                </select>

                <div id="persoBox" class="hidden space-y-4">
                    <input type="text" id="textAv" placeholder="Texte à imprimer" class="input-apple w-full text-center uppercase">
                    <select id="fontAv" class="input-apple w-full">
                        <option value="font-bebas">Bebas Neue (Standard)</option>
                        <option value="font-edo">EDO (Artistique)</option>
                        <option value="font-rodeo">Rodeo (Vintage)</option>
                    </select>
                </div>

                <div id="imageBox" class="hidden space-y-3">
                    <input type="file" id="fileAv" class="hidden" accept="image/*" onchange="previewFile(this)">
                    <button onclick="document.getElementById('fileAv').click()" class="w-full py-3 bg-white border border-gray-200 rounded-xl text-[11px] font-bold uppercase">Aller chercher le logo client</button>
                </div>

                <div class="flex flex-wrap gap-3 justify-center" id="palette"></div>
                <input type="range" id="sizeRange" min="10" max="100" value="60" class="w-full accent-black" oninput="document.getElementById('valSize').innerText=this.value+'MM'">
            </div>

            <button onclick="generer()" class="w-full bg-black text-white py-5 rounded-2xl font-bold uppercase tracking-[0.2em] shadow-xl hover:bg-zinc-800 transition-all">Générer Fiche A6</button>
        </div>
    </div>

    <div id="fiches" class="flex flex-col items-center gap-10"></div>

    <script>
        const colors = [{n:'Noir', v:'#000'}, {n:'Blanc', v:'#fff'}, {n:'Or', v:'#d4af37'}, {n:'Rouge', v:'#f00'}, {n:'Bleu', v:'#0071e3'}];
        let selColor = '#000', imgData = null;

        function init() {
            const p = document.getElementById('palette');
            colors.forEach(c => {
                const b = document.createElement('div');
                b.className = `color-dot ${c.n==='Noir'?'active':''}`;
                b.style.background = c.v;
                b.onclick = () => {
                    p.querySelectorAll('.color-dot').forEach(x => x.classList.remove('active'));
                    b.classList.add('active');
                    selColor = c.v;
                };
                p.appendChild(b);
            });
        }

        function updateUI() {
            const v = document.getElementById('typeAv').value;
            document.getElementById('persoBox').classList.toggle('hidden', v !== 'PERSO');
            document.getElementById('imageBox').classList.toggle('hidden', v !== 'LOGO CLIENT');
        }

        function previewFile(input) {
            const reader = new FileReader();
            reader.onload = (e) => { imgData = e.target.result; };
            reader.readAsDataURL(input.files[0]);
        }

        function generer() {
            const id = Date.now();
            const client = document.getElementById('client').value || "CLIENT";
            const type = document.getElementById('typeAv').value;
            const size = document.getElementById('sizeRange').value;
            const fiche = document.createElement('div');
            fiche.className = "fiche-a6 animate-in fade-in duration-500";

            let content = '';
            if(type === 'PERSO') {
                content = `<p class="${document.getElementById('fontAv').value}" style="color:${selColor}; font-size:${size/1.5}pt; line-height:1;">${document.getElementById('textAv').value || 'TEXTE'}</p>`;
            } else if(type === 'LOGO CLIENT') {
                content = imgData ? `<img src="${imgData}" style="width:${size}mm;">` : '';
            } else if(type !== 'SANS') {
                content = `<p class="font-bebas" style="color:${selColor}; font-size:${size/1.2}pt;">${type}</p>`;
            }

            fiche.innerHTML = `
                <div class="w-full border-b pb-4 text-left flex justify-between items-end">
                    <div>
                        <h2 class="text-3xl font-black tracking-tighter leading-none">${client.toUpperCase()}</h2>
                        <p class="text-blue-600 text-[10px] font-bold mt-1 tracking-widest uppercase">H-001 — TAILLE ${document.getElementById('taille').value}</p>
                    </div>
                    <div class="text-[8px] opacity-20 font-bold uppercase tracking-widest">A6 Prod</div>
                </div>

                <div class="tshirt-preview">
                    <div class="logo-overlay">
                        ${content}
                    </div>
                </div>

                <div class="w-full text-center">
                    <p class="text-[7px] font-bold opacity-30 uppercase tracking-[0.3em] mb-4">Positionnement Centré — ${size}mm</p>
                    <div class="no-print w-full flex gap-1.5" id="st-${id}">
                        <button class="step-pill step-active" onclick="st('${id}',0)">Attente</button>
                        <button class="step-pill" onclick="st('${id}',1)">Reçu</button>
                        <button class="step-pill" onclick="st('${id}',2)">Prod</button>
                        <button class="step-pill" onclick="st('${id}',3)">Fini</button>
                    </div>
                </div>
                <button onclick="this.closest('.fiche-a6').remove()" class="no-print text-[7px] font-bold opacity-10 mt-4 uppercase">Supprimer</button>
            `;
            document.getElementById('fiches').prepend(fiche);
        }

        function st(id, idx) {
            const steps = document.getElementById(`st-${id}`).querySelectorAll('.step-pill');
            steps.forEach((s, i) => s.className = i <= idx ? "step-pill step-active" : "step-pill");
        }

        init();
    </script>
</body>
</html>
